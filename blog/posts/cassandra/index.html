<!DOCTYPE html>
<html lang="en-us">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<link rel="apple-touch-icon" sizes="180x180" href="/blog/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/blog/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/blog/favicon-16x16.png">
	<link rel="manifest" href="/blog/site.webmanifest">
	<link rel="mask-icon" href="/blog/safari-pinned-tab.svg" color="">
	<link rel="shortcut icon" href="/blog/favicon.ico">
	<title>Cassandra - A Decentralized Structured Storage System</title>
	<link rel="stylesheet" href="/blog/css/style.min.4fecf4c2d95f896869e64f36a14369caef0eeb1b4beab0f48c949aa99d18cc07.css" integrity="sha256-T+z0wtlfiWhp5k82oUNpyu8O6xtL6rD0jJSaqZ0YzAc=">
	
</head>

<body id="page">
	
	<header id="site-header" class="animated slideInUp faster">
		<div class="hdr-wrapper section-inner">
			<div class="hdr-left">
				<div class="site-branding">
					<a href="https://millyz.github.io/blog/">The Evening Paper</a>
				</div>
				<nav class="site-nav hide-in-mobile">
					<a href="/blog/posts/">Posts</a>
					<a href="/blog/about/">About</a>
				</nav>
			</div>
			<div class="hdr-right">
				<div class="hdr-icons">
					<span class="hide-in-mobile"><a href="https://github.com/millyz" target="_blank" rel="noopener"><span class="screen-reader-text">github</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a></span>
					<button id="menu-btn" class="hdr-btn"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button>
				</div>
			</div>
		</div>
	</header>
	<div id="mobile-menu" class="animated fast" style="display: none;">
		<ul>
			<li><a href="/blog/posts/">Posts</a></li>
			<li><a href="/blog/about/">About</a></li>
		</ul>
	</div>

	<main class="site-main section-inner animated fadeIn faster">
		<article class="thin">
			<header class="post-header">
				<div class="post-meta"><span>Jan 28, 2019</span></div>
				<h1>Cassandra - A Decentralized Structured Storage System</h1>
			</header>
			<div class="content">
				

<p>Cassandra is a distributed storage system for structured data spread out across many commodity servers, while providing high availability, durability, and scalability. It achieves high write throughput and read efficiency.</p>

<h3 id="system-architecture">System architecture</h3>

<ul>
<li>Partition, Membership, and Scalability

<ul>
<li>Cassandra partitions data across the cluster using <a href="https://www.akamai.com/es/es/multimedia/documents/technical-publication/consistent-hashing-and-random-trees-distributed-caching-protocols-for-relieving-hot-spots-on-the-world-wide-web-technical-publication.pdf" target="_blank">consistent hashing</a> (an order preserving hash function). Each data item identified by a key is assigned to a node, which is the <strong>coordinator</strong> of for this key. The advantage of consistent hashing is that departure or arrival of a node only affects its neighbours but this may result in load imbalance and ignorance of heterogeneity. To tackle this, Cassandra analyzes local information on the ring and have lightly loaded nodes move on the ring to alleviate heavily-loaded servers.</li>
<li>Cluster membership in Cassandra is based on Scuttlebutt, an efficient anti-entropy Gossip based mechanism.</li>
<li>When a node joins the cluster, Cassandra would move some data on ole machines to the new one. <strong>Q</strong>, then how consistent hashing works when this happens and later read/write workloads?</li>
</ul></li>
<li>Failure handling

<ul>
<li>Replication

<ul>
<li>Each data item is replicated at N hosts and its coordinator takes in charge of the replicas.</li>
<li>Cassandra provides various replication policies, &ldquo;rack unaware&rdquo;, &ldquo;rack aware&rdquo;, and &ldquo;datacenter aware&rdquo;. One point is to satisfy the requirement of placement. Here Cassandra elects a leader amongst the nodes using Zookeeper, which tells a newly-joined node what ranges they are responsible for.</li>
<li>Cassandra considers data center failure where each row is replicated across multiple data centers.</li>
</ul></li>
<li>Failure detection

<ul>
<li>Cassandra implements <strong>accrual failure detector</strong>, where the failure detection module emits a value representing a suspicion level for each of monitored nodes.</li>
</ul></li>
<li>Data persistence

<ul>
<li>Typical write operation writes data into a commit log for durability.</li>
<li>All writes are sequential to disk and generate an index for efficient lookup based on row key.</li>
<li>To look up a key efficiently on disk, Cassandra employs a bloom filter to summarize the keys in each file.</li>
</ul></li>
</ul></li>
</ul>

<h2 id="references">References</h2>

<ul>
<li><a href="https://www.cs.cornell.edu/projects/ladis2009/papers/lakshman-ladis2009.pdf" target="_blank">Paper</a></li>
<li><a href="http://cassandra.apache.org/" target="_blank">Apache Cassandra</a></li>
</ul>

			</div>
			<hr class="post-end">
			<footer class="post-info">
				<p>
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="https://millyz.github.io/blog/tags/paper-reading">Paper Reading</a></span><span class="tag"><a href="https://millyz.github.io/blog/tags/erasure-coding">Erasure coding</a></span>
				</p>
				<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>320 Words</p>
				<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2019-01-28 17:21 &#43;0800</p>
			</footer>
		</article>
		<div class="post-nav thin">
			<a class="next-post" href="https://millyz.github.io/blog/posts/sagedb-cidr19/">
				<span class="post-nav-label"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>&nbsp;Newer</span><br><span>SageDB:A Learned Database System, CIDR19</span>
			</a>
			<a class="prev-post" href="https://millyz.github.io/blog/posts/neat-osdi18/">
				<span class="post-nav-label">Older&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg></span><br><span>An Analysis of Network-Partitioning Failures in Cloud Systems</span>
			</a>
		</div>
	</main>

<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML">
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script>

	<script>let haveHeader = true;</script>

	<script src="/blog/js/main.min.00689ba18bbf9422fda222b02b555f01d54bfbb9b6d02f9bcffad67bdb2ff2cd.js" integrity="sha256-AGiboYu/lCL9oiKwK1VfAdVL+7m20C+bz/rWe9sv8s0="></script>
	
</body>

</html>